training configs borrowed from TiTok 
infer config modified from TiTok